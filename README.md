# Модель детекции аномалий установки глубинной камеры на банкоматы

## Краткое описание работы
Данный код написан в рамках выполнения выпускной квалификационной работы магистра. 
В рамках работы решалась задача нахождения аномалий установки глубинной камеры Intel Realsense на банкоматах относительно 
объектов освещения.

Данная задача возникла в ходе анализа причин влияющих на понижение конверсии от попытки входа 
в систему с помощью биометрического модуля до факта входа. На момент начала разработки
конверсия составляла 60%. Алгоритм помогает выявить неисправные с точки зрения биометрии
банкоматы и оперативно вмешаться в проблему техническим специалистам.

---

## Результаты работы

1. Поставлена ML задача согласно бизнес-требованиям
2. Собран, размечен, проанализирован набор данных размером более 6000 изображений
3. Разработаны 3 подхода к решению задачи
4. Протестированы более 20 различных моделей машинного обучения
5. Выбрана лучшая модель и встроена в качестве конечного решения
6. Собраны онлайн метрики: конверсия входа увеличена с 60% до 84%

Проделанная работа позволила существенно улучшить клиентский опыт пользователей биометрии и
повысить ключевые показатели отдела биометрии.

---

**Работу выполнил:** студент группы М8О-207-22 Биро Илья Олегович

**Дипломный руководитель:** доцент, к.т.н., Булакина Мария Борисовна, доцент кафедры 806 МАИ

---

```commandline
python3 -m pip install -r requirements.txt
python3 main.py [SC | CMC] # <-- Запуск эксперимента.
```
`SC` - эксперимент с применением фильтра Собела к изображению и последующей классификацией с помощью
различных классических ML моделей.

`CMC` - эксперимент с расчётом карты корреляций круговых фильтров с изображением и последующей классификацией с помощью
различных классических ML моделей.

Эксперимент с нейросетевыми моделями не вошел в открытый репозиторий в силу высокого отношения NDA кода с использованием внутренних
инструментов организации.

---
## Вспомогательные инструменты

### Инструмент для сбора данных с камеры

Для сбора данных с камеры разработана простейшая программа на основе Tkinter.
Для запуска программы можно использовать следующие команды:

```commandline
python3 -m pip install -r requirements.txt
cd data_grabber 
main.py
```

Результатом работы программы станет директория `data_grabber/saved` с сохраненными файлами изображений.

### Инструмент для разметки данных

Для разметки данных с камеры разработана простейшая программа на основе Tkinter.
Для запуска программы можно использовать следующие команды:

```commandline
python3 -m pip install -r requirements.txt
cd data_labeling 
main.py
```

Результатом работы программы станет файл `data_labeling/saved.json` с разметкой вида:
```json
{
  "/path/to/file/0.png": 0,
  "/path/to/file/1.png": 1,
  "/path/to/file/2.png": 0,
  "/path/to/file/3.png": 1,
  "/path/to/file/4.png": 1,
  ...
}
```
